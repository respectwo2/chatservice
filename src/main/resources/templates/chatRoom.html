<!DOCTYPE html>
<html>
<head>
    <title>채팅방</title>
    <meta charset="UTF-8">
</head>
<body>
    <div id="chat">
        <div id="messages" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc;"></div>
        <input type="text" id="messageInput" placeholder="메시지를 입력하세요">
        <button id="sendButton">보내기</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
    <script>
		let ws;
		function connect() {
		    const roomId = new URLSearchParams(window.location.search).get('room_id');
		    const sockJsUrl = `http://localhost:8080/chatRoom/sockjs?roomId=${roomId}`;
		    ws = new SockJS(sockJsUrl);
		
		    ws.onopen = function() {
		        console.log('Connection to room', roomId, 'opened');
		    };
		
		    ws.onmessage = function(event) {
		        let message = JSON.parse(event.data);
		        document.getElementById('messages').innerHTML += '<div>' + message + '</div>';
		    };
		
		    ws.onclose = function() {
		        console.log('Connection closed');
		    };
		
		    ws.onerror = function(error) {
		        console.error('WebSocket error:', error);
		    };
		}
		
		document.getElementById('sendButton').addEventListener('click', function() {
		    let messageContent = document.getElementById('messageInput').value;
		    if (messageContent && ws) {
		        ws.send(JSON.stringify({ content: messageContent }));
		        document.getElementById('messageInput').value = '';
		    }
		});
		
		window.onload = function() {
		    connect();
		};
		
	</script>
</body>
</html>
